use aiken/collection/list
use ak_381/groth16.{Proof, SnarkVerificationKey, groth_verify}

/// This code is autogenerated by "Cardano ZK Aiken"
pub type ZKInputType {
  Single(Int)
  Many(List<Int>)
}

fn flatten_public_inputs(public_inputs: List<ZKInputType>) -> List<Int> {
  list.flat_map(
    public_inputs,
    fn(item) {
      when item is {
        Single(x) -> [x]
        Many(xs) -> xs
      }
    },
  )
}

pub fn zk_verify(
  proof: Proof,
  public_inputs: List<ZKInputType>,
  vk: SnarkVerificationKey,
) -> Bool {
  let flattened_public_inputs: List<Int> = flatten_public_inputs(public_inputs)

  groth_verify(vk, proof, flattened_public_inputs)
}

pub fn empty_circuit_vk() -> SnarkVerificationKey {
  SnarkVerificationKey {
    nPublic: 1,
    vkAlpha: #"85e3f8a13a670514351a68677ea0e2fc51150daeea496b85a34d97751695e26b2ae4f1a5a3b60e17bb7bfd6d474154c5",
    vkBeta: #"b1abf58f58af5981cd24f996e53626a4157eeed4aa814498885b3a547c35d5efb877834602508255c030708552b353e21631f16475e35b977e39a068ac9fb5bc4c25d383139b721da0a878b663c4df52c94a51f7c06a019bb40324713d2bbf0f",
    vkGamma: #"93e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8",
    vkDelta: #"b824005d651bf6d38362f30967f78a33381fde734ebd5687265d2b250f54aa5b10860c1e0cd522e375a7f04178efe69c0747d9ee650176e8376346111c82fd997c3b16604ef241edd84843e9d84a3fd3833bcb2308b5ce4dfa9f465b18dbec7c",
    vkAlphaBeta: [],
    vkIC: [
      #"b8fcac9bb8eebddd4daf43519eb65d952436f5e98be287e246d70fc27f267379e132a156f6a4a742ece62fbb7c5e220d",
      #"99f6c043cc37650767938eb567327aca0e82fb1dcab833778a6b8d5c8d13a8f53d784e7dfbcba6d3c71b57b908530048",
    ],
  }
}
