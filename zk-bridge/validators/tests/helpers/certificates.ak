use aiken/primitive/string
use certificate_metadata.{
  CertificateMetadata, ProtocolParameters, ProtocolVersion,
  StakeDistributionParty,
}
use certificate_signature.{
  CardanoTransactions, GenesisSignature, MithrilStakeDistribution,
  MultiSignature,
}
use mithril_certificate.{MithrilCertificate}
use protocol_message.{
  CardanoTransactionsMerkleRoot, CurrentEpoch, LatestBlockNumber,
  NextAggregateVerificationKey, NextProtocolParameters, ProtocolMessage,
  SnapshotDigest,
}
use utils.{digest_to_bytes_of_string}

fn certificate_metadata_for_new_certificate(parent_certificate: MithrilCertificate) {
    CertificateMetadata {
    network: parent_certificate.metadata.network,
    protocol_version: parent_certificate.metadata.protocol_version,
    protocol_parameters: parent_certificate.metadata.protocol_parameters,
    initiated_at: parent_certificate.metadata.initiated_at,
    sealed_at: parent_certificate.metadata.sealed_at,
    signers: [
      StakeDistributionParty { party_id: "1", stake: 10 },
      StakeDistributionParty { party_id: "2", stake: 20 },
    ],
  }
}

pub fn mock_certificate_metadata() -> CertificateMetadata {
  CertificateMetadata {
    network: "testnet",
    protocol_version: ProtocolVersion("0.1.0"),
    protocol_parameters: ProtocolParameters {
      k: 1000,
      m: 100,
      phi_f: #"001f7cee",
    },
    initiated_at: #"17b31fabeef2bdac",
    sealed_at: #"17b31fc33769a5ac",
    signers: [
      StakeDistributionParty { party_id: "1", stake: 10 },
      StakeDistributionParty { party_id: "2", stake: 20 },
    ],
  }
}

pub fn mock_protocol_message(epoch: Int) -> ProtocolMessage {
  [
    Pair(SnapshotDigest, @"snapshot-digest-123"),
    Pair(
      NextAggregateVerificationKey,
      @"7b226d745f636f6d6d69746d656e74223a7b22726f6f74223a5b37332c37342c3232392c3235302c3132322c3232362c38392c33372c3233312c3234352c3130362c3138332c3132372c332c39392c3137372c3231372c36352c3135322c3133352c33322c36372c3232332c33352c3134312c35312c342c3132352c3230332c33382c3139362c3231325d2c226e725f6c6561766573223a32342c22686173686572223a6e756c6c7d2c22746f74616c5f7374616b65223a35323337353137363336353838327d",
    ),
    Pair(CurrentEpoch, string.from_int(epoch)),
  ]
}

/// Obtained with https://aggregator.pre-release-preview.api.mithril.network/aggregator/certificate/genesis
pub fn simple_genesis_certificate() -> MithrilCertificate {
  MithrilCertificate {
    prev_hash: "",
    hash: #"d6b8be9f69f9a4c304ddaadba8c7ba18b98faf88aa1bc7c372cfc24b34c35c69",
    epoch: 1129,
    metadata: CertificateMetadata {
      network: "preview",
      protocol_version: ProtocolVersion("0.1.0"),
      protocol_parameters: ProtocolParameters {
        k: 5,
        m: 100,
        // phi_f = 0.65
        phi_f: #"00a66666",
      },
      // initiated_at = 2025-11-27T12:04:10.769673406Z
      initiated_at: #"187bdb86bbde0cbe",
      // sealed_at = 2025-11-27T12:04:10.769675068Z
      sealed_at: #"187bdb86bbde133c",
      signers: [],
    },
    protocol_message: [
      Pair(
        NextAggregateVerificationKey,
        @"7b226d745f636f6d6d69746d656e74223a7b22726f6f74223a5b3235352c3130352c312c3133322c3232342c33362c3139392c37382c3138352c36362c3230392c3138332c3230342c3139332c3138392c3137352c33392c35332c3139392c3134352c3138372c39372c3234312c3230302c3232382c3232302c302c3130382c3136332c3130372c3131312c3230325d2c226e725f6c6561766573223a31392c22686173686572223a6e756c6c7d2c22746f74616c5f7374616b65223a313231303337383339303633353238307d",
      ),
      Pair(
        NextProtocolParameters,
        @"b01de82ca7e57c1bf2a56381ce265f378aeea5f1dde7f824b5ba42125c4adad2",
      ), Pair(CurrentEpoch, @"1129"),
    ],
    signed_message: digest_to_bytes_of_string(
      #"0aaec4af58ecce8ed20405808cfc6d01884c36152d0e17bc9470470d1de09cc8",
    ),
    aggregate_verification_key: digest_to_bytes_of_string(
      #"7b226d745f636f6d6d69746d656e74223a7b22726f6f74223a5b3235352c3130352c312c3133322c3232342c33362c3139392c37382c3138352c36362c3230392c3138332c3230342c3139332c3138392c3137352c33392c35332c3139392c3134352c3138372c39372c3234312c3230302c3232382c3232302c302c3130382c3136332c3130372c3131312c3230325d2c226e725f6c6561766573223a31392c22686173686572223a6e756c6c7d2c22746f74616c5f7374616b65223a313231303337383339303633353238307d",
    ),
    signature: GenesisSignature {
      // NOTA: En la API devuelve el siguiente signed_entity_type, sin embargo al calcular el hash no se usa
      // signed_entity_type: MithrilStakeDistribution { epoch: 1129 },
      signature: digest_to_bytes_of_string(
        #"8cdd1190c191475b160472539a24d269070c040782adf0f5af32bf89142650d080da36986f74827cb214985ffe2b5dc6fd7c16c8aa7293c014802c61b099d60e",
      ),
    },
  }
}

/// Obtained with https://aggregator.pre-release-preview.api.mithril.network/aggregator/certificate/062028d9a71eb9178dabe0018d161d5bc6773a331c3759f8f05661718296387f
/// NOTE: This certificate's parent is `simple_genesis_certificate()`
pub fn simple_sd_certificate() -> MithrilCertificate {
  MithrilCertificate {
    // It is very important to notice that we are passing a string here. Since this is how Mithril processes it.
    prev_hash: string.to_bytearray(
      @"d6b8be9f69f9a4c304ddaadba8c7ba18b98faf88aa1bc7c372cfc24b34c35c69",
    ),
    hash: #"062028d9a71eb9178dabe0018d161d5bc6773a331c3759f8f05661718296387f",
    epoch: 1130,
    metadata: CertificateMetadata {
      network: "preview",
      protocol_version: ProtocolVersion("0.1.0"),
      protocol_parameters: ProtocolParameters {
        k: 5,
        m: 100,
        // phi_f = 0.65
        phi_f: #"00a66666",
      },
      // initiated_at = 2025-11-28T00:02:32.958938259Z
      initiated_at: #"187c02ba3e8c2c93",
      // sealed_at = 2025-11-28T00:03:32.954265042Z
      sealed_at: #"187c02c8368c35d2",
      signers: [
        StakeDistributionParty {
          party_id: "pool1xgmqwh23yc2jp52k7jn249x56v6nyhl9nhxaeg6hq8tmc5t78rq",
          stake: 13617227733327,
        },
        StakeDistributionParty {
          party_id: "pool15jqsjphnxg7hcx2rvd0ryhg5xwshg7xktthj3zf70nmxx9ffjet",
          stake: 460613554490,
        },
        StakeDistributionParty {
          party_id: "pool1knap9hldvhww0fjqew26sxkfjpj3c8tp8uuj7j3729lzqn9x70r",
          stake: 49960508305352,
        },
        StakeDistributionParty {
          party_id: "pool1y0uxkqyplyx6ld25e976t0s35va3ysqcscatwvy2sd2cwcareq7",
          stake: 45661020404878,
        },
        StakeDistributionParty {
          party_id: "pool1myvqymdmf9f26746d6uvfk34hqr7lq998n43xprgz4c27tpa6rd",
          stake: 1232019292237,
        },
      ],
    },
    protocol_message: [
      Pair(
        NextAggregateVerificationKey,
        @"7b226d745f636f6d6d69746d656e74223a7b22726f6f74223a5b31312c3130312c3232362c3138372c36392c3230382c3135332c33362c3139372c3232352c34302c3235332c3135332c33382c3139342c3136362c3133352c3137392c3230392c33312c3134362c32372c37382c3137302c34312c3139302c3138372c3136342c39382c34322c3131322c36305d2c226e725f6c6561766573223a31392c22686173686572223a6e756c6c7d2c22746f74616c5f7374616b65223a313231303536363437313039333432347d",
      ),
      Pair(
        NextProtocolParameters,
        @"b01de82ca7e57c1bf2a56381ce265f378aeea5f1dde7f824b5ba42125c4adad2",
      ), Pair(CurrentEpoch, @"1130"),
    ],
    signed_message: digest_to_bytes_of_string(
      #"d5b0115f14a1db581ef039bb343a200a07c2c1e38b3388a4fc07b09e7b5b844f",
    ),
    aggregate_verification_key: digest_to_bytes_of_string(
      #"7b226d745f636f6d6d69746d656e74223a7b22726f6f74223a5b3235352c3130352c312c3133322c3232342c33362c3139392c37382c3138352c36362c3230392c3138332c3230342c3139332c3138392c3137352c33392c35332c3139392c3134352c3138372c39372c3234312c3230302c3232382c3232302c302c3130382c3136332c3130372c3131312c3230325d2c226e725f6c6561766573223a31392c22686173686572223a6e756c6c7d2c22746f74616c5f7374616b65223a313231303337383339303633353238307d",
    ),
    signature: MultiSignature {
      signed_entity_type: MithrilStakeDistribution { epoch: 1130 },
      signature: digest_to_bytes_of_string(
        #"7b227369676e617475726573223a5b5b7b227369676d61223a5b3137382c36302c3136322c3138352c3130372c32302c3136362c3135332c32352c32392c3235342c3234392c3230382c3232382c38312c3138382c32312c3230332c3135302c3234362c3131352c3134302c31312c3230362c39392c36342c3139332c3233342c32392c3133362c3138342c34382c3231392c3233342c37332c31312c33322c33352c34352c39312c34352c3139392c3132362c3137362c3231382c32362c3139352c3136345d2c22696e6465786573223a5b345d2c227369676e65725f696e646578223a347d2c5b5b3138302c3230342c3233372c3230342c3232382c32302c3135312c3138372c3131352c3134342c3138302c31312c3134332c3134312c3232342c38322c32372c3235322c35312c3232322c3232322c36382c37352c32372c39362c34382c3235352c35352c3232332c332c37302c3135362c37322c35302c342c3234372c3139382c3130302c3235302c3230322c3135332c3231372c31302c3136352c32382c3232332c3139352c32342c32322c3134382c38382c37322c3135342c3234382c3131392c3130342c3133362c3234352c34302c3230352c3133332c3234332c332c3132352c34392c3133322c34392c3137332c3135392c3139322c3130332c3137332c3230322c3137342c3234322c36322c3133312c38362c31352c3137392c37332c36362c3233392c3137302c3130372c3134362c3234312c3231352c35372c38332c3134342c3133302c3233382c3230392c3232302c31345d2c313233323031393239323233375d5d2c5b7b227369676d61223a5b3134342c34362c37322c3231332c3135302c3233342c3132382c3133322c3138362c33352c3232342c33382c3136332c3233312c3135382c3137322c38342c3132322c32312c3235302c3232302c3231352c38372c3233322c35342c3234342c3131302c3136342c38372c39332c33332c3130342c38312c3233332c3138312c32392c3235312c32362c3138332c3235332c3134362c39332c3138342c3136322c3136312c35392c3235312c3231375d2c22696e6465786573223a5b33342c35382c38325d2c227369676e65725f696e646578223a31317d2c5b5b3137382c35372c3232382c3231362c3235322c39322c32302c36362c3137312c35372c3232332c31372c3230322c33372c3135362c37342c33332c3233362c3131392c3230362c3130372c3133372c3133302c3230342c3233312c34372c3136312c3131312c3135352c32382c3136312c31302c3234322c3131372c31302c3230302c3134352c32382c36372c37312c3233382c3235342c3131352c3130392c3135302c3133342c3137322c3135362c382c37342c3138392c3233362c3233302c3232352c3233372c3235302c36342c3137382c312c37372c3232382c3133342c3135342c3137302c34332c3133362c32302c39312c3137302c33322c3131332c3132382c3138372c3131382c3132322c38302c3133352c3138362c3234332c3232392c35392c3134382c3230302c3135322c3131382c3133302c37382c3130382c3233322c3132322c3133302c31352c3133372c36302c37352c3137365d2c31333631373232373733333332375d5d2c5b7b227369676d61223a5b3137362c3136332c38352c302c3134322c3135392c31372c36342c3130312c31342c3231392c3138352c3139332c3135342c38302c3138392c34392c3131382c3130302c32332c3136392c31372c33392c34362c3137332c3230382c37352c3136392c362c3136352c3232392c3136302c35382c3134372c36372c3134322c32322c372c3139382c34362c3137342c3235332c3230372c3137322c39332c3130312c3233342c3133365d2c22696e6465786573223a5b31302c34312c39395d2c227369676e65725f696e646578223a31347d2c5b5b3138352c3137302c31322c3134362c35322c33342c35392c3136332c3131322c3130392c3235332c3137362c35322c39382c3135352c3134392c3135332c342c39322c3132342c3136362c3233302c3132302c37342c31332c322c39312c3232342c33302c3232382c3133332c3235352c3139302c3137352c3131392c3233352c372c39352c3136342c3130322c3234312c3233362c32302c31392c3133372c35312c342c3130352c31302c37372c3131342c31302c38342c36332c38302c3134362c33302c3235332c3138332c332c3133302c37362c35332c3230382c35392c3232372c39332c37332c3137302c3138352c3131352c3233302c3231352c3139342c3235322c3137312c3130362c3235332c3231322c3233392c3138352c3130332c36352c3136392c38342c39342c39302c3135322c3135302c3138372c3135372c3134342c3231322c362c38382c39375d2c34353636313032303430343837385d5d5d2c2262617463685f70726f6f66223a7b2276616c756573223a5b5b3231382c3139322c38302c37352c37302c3131352c3131372c34352c3232312c3136342c3137302c3137322c39392c31322c32312c37322c3136382c3132372c382c3133302c3132362c39392c322c3133392c34302c3134322c38372c3139372c37372c38322c31312c37385d2c5b39372c3133312c3233372c35312c36332c3134342c33332c34342c35322c3234322c3136322c36372c3132312c3136362c35352c3235332c39392c3132372c3131312c34352c35362c3138362c32392c33322c3231382c3232322c3132342c36382c3131382c32342c35382c3135315d2c5b3132332c382c3138382c34312c3137392c3136382c3234312c35392c39312c32312c3231392c332c3138392c3135322c37382c3132342c3234392c37392c33342c39312c3234362c3235322c32302c3131302c33342c3231372c3132342c35352c3131392c382c3137302c3132335d2c5b3231362c37332c3138302c33312c3234342c3139372c35372c3131342c3130302c3231372c3231332c3232322c3139332c3137382c3134302c3233382c3233342c3233352c35352c3139332c3137392c38392c33302c3137312c3132332c3231372c3134332c39352c3230332c3230392c302c32375d2c5b3135392c3135362c3233342c3137382c3232332c3234362c3235332c3231322c3138312c3234322c35372c32312c3234362c3132332c3135392c31382c3138372c3131302c3234392c31372c35352c3231302c3134362c3139322c3132372c32382c342c3132312c36372c31312c3135372c355d2c5b3132322c3137362c3137312c3231302c3232372c3138352c3132352c3130342c382c3135352c3233332c33302c3231302c31392c3138312c382c32302c3137342c31382c36352c3233322c3133332c3132372c3231362c3230322c3232342c3130372c3230372c3132362c35352c3230342c38305d2c5b3230352c38382c37382c382c3134362c3135392c3231352c39392c3233352c3134342c36352c39362c312c3131332c33322c3130382c34332c3136312c37342c35392c32382c38302c3138392c3233342c3230332c32302c3131362c39362c31352c3233372c3139322c335d2c5b32382c39302c37392c3134322c382c35392c3133302c3131302c36322c3234302c3232372c32352c33382c38362c3131352c33302c39322c3234312c36322c3130342c3233332c3136312c31362c3133312c37332c31312c3139312c3133332c3137312c37352c3234372c33365d5d2c22696e6469636573223a5b342c31312c31345d2c22686173686572223a6e756c6c7d7d",
      ),
    },
  }
}

/// Obtained with 
pub fn parent_of_simple_sd_certificate() -> MithrilCertificate {
  simple_genesis_certificate()
}

/// Obtained with https://aggregator.pre-release-preview.api.mithril.network/aggregator/certificate/2c805fbc231839ae0378f61ecf2c9003a76a84b2365e6606e997c8eaa2e3a663
pub fn simple_cardano_transactions_certificate() -> MithrilCertificate {
  MithrilCertificate {
    prev_hash: string.to_bytearray(
      @"00a5e9ef826387c595d2e7cff950cf0a995546afc67d3c3ca8583e2c11496606",
    ),
    hash: #"2c805fbc231839ae0378f61ecf2c9003a76a84b2365e6606e997c8eaa2e3a663",
    epoch: 1150,
    metadata: CertificateMetadata {
      network: "preview",
      protocol_version: ProtocolVersion("0.1.0"),
      protocol_parameters: ProtocolParameters {
        k: 5,
        m: 100,
        // phi_f = 0.65
        phi_f: #"00a66666",
      },
      // initiated_at = 2025-12-18T14:52:35.246548514Z
      initiated_at: #"188256e7491a4622",
      // sealed_at = 2025-12-18T14:53:32.973550729Z
      sealed_at: #"188256f4b9e66c89",
      signers: [
            StakeDistributionParty {
                party_id: "pool1y0uxkqyplyx6ld25e976t0s35va3ysqcscatwvy2sd2cwcareq7",
                stake: 47229585763795
            },
            StakeDistributionParty {
                party_id: "pool19ta77tu28f3y7m6yjgnqlcs98ak6a0vvtlcn7mc52azpwr4l2xt",
                stake: 12291216313820
            },
            StakeDistributionParty {
                party_id: "pool1knap9hldvhww0fjqew26sxkfjpj3c8tp8uuj7j3729lzqn9x70r",
                stake: 51473583496949
            },
            StakeDistributionParty {
                party_id: "pool1ewxvkzqnvfzaf48092n4t2crdventhxhtmpvydxnsnj322qc47c",
                stake: 5966300630241
            },
            StakeDistributionParty {
                party_id: "pool1wjz475nwhq3fnhfvrjesf4pw70k27fnc5mzvsrzqlxfhy60rmu3",
                stake: 2839390182192
            },
            StakeDistributionParty {
                party_id: "pool1u2pl6kx4yc77lnyapnveykkpnj07fmc7pd66fa40fvx3khw7cua",
                stake: 11339750321164
            },
            StakeDistributionParty {
                party_id: "pool1407hpuvtp9ww8s5mt53ear7062j463mvwhnypurlcask7djg3ae",
                stake: 12826371336746
            },
            StakeDistributionParty {
                party_id: "pool1wluhmx9pe67vhgxz9x46ffym3kymq2gqvshmycz8smwpclttqz5",
                stake: 1142442571200
            },
            StakeDistributionParty {
                party_id: "pool12yrhvezsrqxlafahf02ka28a4a3qxgcgkylku4vqjg385jh60wa",
                stake: 11306054674889
            },
            StakeDistributionParty {
                party_id: "pool1myvqymdmf9f26746d6uvfk34hqr7lq998n43xprgz4c27tpa6rd",
                stake: 1243282108196
            },
            StakeDistributionParty {
                party_id: "pool1q65ag8panwayzaqfs6je7jz2ywt8x2032yaunq5hf25t7t8c26e",
                stake: 11146103144242
            }
      ],
    },
    protocol_message: [
      Pair(
        CardanoTransactionsMerkleRoot,
        @"fd8f647ef7a2de1b0e29f9e6a119e8846be9b20098a39f1cdfe46273f97166d4",
      ),
      Pair(
        NextAggregateVerificationKey,
        @"7b226d745f636f6d6d69746d656e74223a7b22726f6f74223a5b3137332c35312c31382c3231392c3230352c3230372c33302c3136362c3232342c3139392c3138322c3137342c3234342c34392c3138352c34362c38392c3131382c3231322c3233372c32392c33382c3138342c3136372c3232322c312c3133382c3135322c39342c35392c39392c38385d2c226e725f6c6561766573223a31362c22686173686572223a6e756c6c7d2c22746f74616c5f7374616b65223a3137363331323733333831383334357d",
      ),
      Pair(
        NextProtocolParameters,
        @"b01de82ca7e57c1bf2a56381ce265f378aeea5f1dde7f824b5ba42125c4adad2",
      ), Pair(CurrentEpoch, @"1150"), Pair(LatestBlockNumber, @"3867929"),
    ],
    signed_message: digest_to_bytes_of_string(
      #"c09d0ed9f608c959638a7af49c4159c05570c4564ae456cf39595622df615751",
    ),
    aggregate_verification_key: digest_to_bytes_of_string(
      #"7b226d745f636f6d6d69746d656e74223a7b22726f6f74223a5b3137382c38392c38392c3233352c38392c32382c33342c302c3231352c3137352c3139322c33372c3138382c3235332c36372c3234362c352c3132332c3137352c3131392c3133302c3135352c3235342c3131352c3135332c3235312c3232332c3233302c33312c3138382c3234352c3137385d2c226e725f6c6561766573223a31362c22686173686572223a6e756c6c7d2c22746f74616c5f7374616b65223a3137363334323930333534303033317d",
    ),
    signature: MultiSignature {
      signed_entity_type: CardanoTransactions {
        epoch: 1150,
        block_number: 3867929,
      },
      signature: digest_to_bytes_of_string(
        #"7b227369676e617475726573223a5b5b7b227369676d61223a5b3132382c38352c3230382c3233322c3234362c34392c3230362c3234312c3230302c38342c3233342c32392c3137342c32302c36322c3131382c37392c37302c3231392c3231322c382c362c3139322c3136362c34352c34382c3233382c3139312c39342c3234322c3138342c31392c31352c31302c37372c3131322c37302c3135312c3131392c39392c3139362c31382c3137302c3137302c3230352c3133372c32322c3131305d2c22696e6465786573223a5b322c392c31302c31312c31332c31382c32312c32322c32362c33372c33392c34322c34332c34352c35302c35312c35352c35382c36342c37302c37362c37372c37392c38342c38352c38372c39312c39332c39345d2c227369676e65725f696e646578223a31357d2c5b5b3134352c3235332c3133332c3134342c35372c3233332c37332c35372c3138352c3231332c3230362c36332c3139342c3234332c39302c3134332c3132332c3233302c3133302c3134312c36332c3135352c37322c32372c3233362c3232332c3232342c37382c3133362c3138312c31332c39332c3134342c35382c34322c3137352c33342c3133322c3138302c39322c3233302c3134332c39392c37342c3131302c3233362c3233392c3234392c332c3231372c32382c38372c332c3135332c31322c3135312c3139362c3231322c38352c33302c3232312c3130302c35392c39342c3231332c3137352c39382c342c3231322c35372c39392c3231312c38352c3131342c38332c32362c3230302c31342c32392c3232362c3139332c39342c33322c39312c3133302c3233302c3235342c34382c3136312c37362c32322c3234352c3130322c38322c32342c3135335d2c35313437333538333439363934395d5d5d2c2262617463685f70726f6f66223a7b2276616c756573223a5b5b3138362c31332c33322c38372c3135332c34392c302c3131312c35382c39382c3133332c3233392c32362c3234382c3133352c3233322c3231322c3233332c3233382c3131382c32332c37302c3234322c3231332c3233332c3233312c34302c3136372c3132312c3130352c3231332c34375d2c5b3234312c3137312c33392c35362c37392c3234342c38302c3133362c3233352c3139382c3135372c3131312c34312c39372c38312c34342c3134352c3230322c3232382c34342c36322c3131382c3136352c3138312c3234362c3235342c31342c38362c362c3234372c35312c3230335d2c5b3132382c39352c3233362c3138342c3231392c3230332c322c392c31332c302c3136382c3139372c3138322c3131322c39312c3130322c3130342c34352c3233322c3233352c3133332c3233322c37372c3130302c322c3136332c32382c3137322c3132392c3235302c3136362c3133325d2c5b3136382c33302c36372c37372c3132392c3133312c3232352c33372c3235332c3233312c3132352c3137322c35312c32382c3131342c35332c3131362c3233372c37382c3134312c3138392c3136392c31372c3132392c3139322c3134322c3231312c3137352c3139312c35302c3136332c3139305d5d2c22696e6469636573223a5b31355d2c22686173686572223a6e756c6c7d7d",
      ),
    },
  }
}

/// Obtained with https://aggregator.pre-release-preview.api.mithril.network/aggregator/certificate/00a5e9ef826387c595d2e7cff950cf0a995546afc67d3c3ca8583e2c11496606
/// NOTE: This certificate is the parent certificate of `simple_cardano_transactions_certificate()`
pub fn parent_of_simple_cardano_transactions_certificate() -> MithrilCertificate {
  MithrilCertificate {
    prev_hash: string.to_bytearray(
      @"71a83776fe5b852b1b0fb437c06b267dfba3f6f67dfd5309fcc23b05e1da94cc",
    ),
    hash: #"00a5e9ef826387c595d2e7cff950cf0a995546afc67d3c3ca8583e2c11496606",
    epoch: 1150,
    metadata: CertificateMetadata {
      network: "preview",
      protocol_version: ProtocolVersion("0.1.0"),
      protocol_parameters: ProtocolParameters {
        k: 5,
        m: 100,
        // phi_f = 0.65
        phi_f: #"00a66666",
      },
      // initiated_at = 2025-12-18T00:03:33.560856248Z
      initiated_at: #"18822663b4e00eb8",
      // sealed_at = 2025-12-18T00:04:32.990418393Z
      sealed_at: #"188226718b2735d9",
      signers: [
        StakeDistributionParty {
          party_id: "pool1y0uxkqyplyx6ld25e976t0s35va3ysqcscatwvy2sd2cwcareq7",
          stake: 47229585763795,
        },
        StakeDistributionParty {
          party_id: "pool1407hpuvtp9ww8s5mt53ear7062j463mvwhnypurlcask7djg3ae",
          stake: 12826371336746,
        },
        StakeDistributionParty {
          party_id: "pool1wluhmx9pe67vhgxz9x46ffym3kymq2gqvshmycz8smwpclttqz5",
          stake: 1142442571200,
        },
        StakeDistributionParty {
          party_id: "pool1myvqymdmf9f26746d6uvfk34hqr7lq998n43xprgz4c27tpa6rd",
          stake: 1243282108196,
        },
      ],
    },
    protocol_message: [
      Pair(
        NextAggregateVerificationKey,
        @"7b226d745f636f6d6d69746d656e74223a7b22726f6f74223a5b3137332c35312c31382c3231392c3230352c3230372c33302c3136362c3232342c3139392c3138322c3137342c3234342c34392c3138352c34362c38392c3131382c3231322c3233372c32392c33382c3138342c3136372c3232322c312c3133382c3135322c39342c35392c39392c38385d2c226e725f6c6561766573223a31362c22686173686572223a6e756c6c7d2c22746f74616c5f7374616b65223a3137363331323733333831383334357d",
      ),
      Pair(
        NextProtocolParameters,
        @"b01de82ca7e57c1bf2a56381ce265f378aeea5f1dde7f824b5ba42125c4adad2",
      ), Pair(CurrentEpoch, @"1150"),
    ],
    signed_message: digest_to_bytes_of_string(
      #"fb7ab50a6373b3ef91dedad10fdd0cd11c88df55e3abd2560ef425ce1c4a090e",
    ),
    aggregate_verification_key: digest_to_bytes_of_string(
      #"7b226d745f636f6d6d69746d656e74223a7b22726f6f74223a5b3137382c38392c38392c3233352c38392c32382c33342c302c3231352c3137352c3139322c33372c3138382c3235332c36372c3234362c352c3132332c3137352c3131392c3133302c3135352c3235342c3131352c3135332c3235312c3232332c3233302c33312c3138382c3234352c3137385d2c226e725f6c6561766573223a31362c22686173686572223a6e756c6c7d2c22746f74616c5f7374616b65223a3137363334323930333534303033317d",
    ),
    signature: MultiSignature {
      signed_entity_type: MithrilStakeDistribution { epoch: 1150 },
      signature: digest_to_bytes_of_string(
        #"7b227369676e617475726573223a5b5b7b227369676d61223a5b3138302c34342c35312c3139392c3139332c3232342c39302c3137372c32312c32382c3134352c39352c3232312c3231362c3234302c3137302c3234332c32322c3137302c35392c3232342c32342c3131362c3135372c3138392c3139382c3231372c3130382c3230392c3135312c3234332c3133342c3130352c3235302c3232332c3137302c3136362c3136362c36392c3233372c3131352c3138302c3235302c3138352c3139352c32372c3233392c3234395d2c22696e6465786573223a5b332c362c31312c31332c31372c32312c32322c32362c32372c32382c33332c33352c33372c34342c34352c35322c36302c36322c36392c37322c37362c38302c38322c38332c39312c39322c39345d2c227369676e65725f696e646578223a31347d2c5b5b3133332c3133312c3133352c3234362c3133322c3232372c33362c3131372c34392c3131342c3233302c3232392c3230322c3137362c31332c34372c37372c33322c3132372c3139362c38322c3136322c31342c34342c3230302c32302c3230322c3136352c302c38332c3137302c3133392c3134372c3134352c3230352c3230322c3231302c38392c3233392c3139352c3232312c3137332c3234352c3230302c38392c38312c33322c3135362c32332c3132332c3130322c36352c33362c34382c3235342c31332c35312c39302c34302c3137392c3132312c3134302c32312c3232302c3134382c31352c3139312c35302c3130302c38332c3230382c3232312c37352c3137322c34382c32392c34322c3130372c3135332c3136312c31342c33382c36392c38392c3134362c38322c3132382c3234392c3230372c3135332c3131322c342c3234372c37362c3139362c385d2c34373232393538353736333739355d5d5d2c2262617463685f70726f6f66223a7b2276616c756573223a5b5b3231392c302c34362c3136322c3231342c3235332c35362c3131352c37372c34362c3133382c3233392c3134332c38312c31382c322c34312c39382c3135372c38352c3135392c32382c3130322c33302c3232302c3230342c3234352c31332c3132302c3135392c3139362c3139335d2c5b3234312c3137312c33392c35362c37392c3234342c38302c3133362c3233352c3139382c3135372c3131312c34312c39372c38312c34342c3134352c3230322c3232382c34342c36322c3131382c3136352c3138312c3234362c3235342c31342c38362c362c3234372c35312c3230335d2c5b3132382c39352c3233362c3138342c3231392c3230332c322c392c31332c302c3136382c3139372c3138322c3131322c39312c3130322c3130342c34352c3233322c3233352c3133332c3233322c37372c3130302c322c3136332c32382c3137322c3132392c3235302c3136362c3133325d2c5b3136382c33302c36372c37372c3132392c3133312c3232352c33372c3235332c3233312c3132352c3137322c35312c32382c3131342c35332c3131362c3233372c37382c3134312c3138392c3136392c31372c3132392c3139322c3134322c3231312c3137352c3139312c35302c3136332c3139305d5d2c22696e6469636573223a5b31345d2c22686173686572223a6e756c6c7d7d",
      ),
    },
  }
}

pub fn standard_certificate_for_hash_test() -> MithrilCertificate {
  MithrilCertificate {
    prev_hash: "previous_hash",
    hash: #"5e341ceeb91cc9957fca96d586e0ff2c66a8d6ec6b90bf84929c060c717094da",
    epoch: 10,
    metadata: CertificateMetadata {
      network: "testnet",
      protocol_version: ProtocolVersion("0.1.0"),
      protocol_parameters: ProtocolParameters {
        k: 1000,
        m: 100,
        // 0.123
        phi_f: #"001f7cee",
      },
      initiated_at: #"17b31fabeef2bdac",
      sealed_at: #"17b31fc33769a5ac",
      signers: [
        StakeDistributionParty { party_id: "1", stake: 10 },
        StakeDistributionParty { party_id: "2", stake: 20 },
      ],
    },
    protocol_message: [
      Pair(SnapshotDigest, @"snapshot-digest-123"),
      // If we use `bytearray.to_hex()` for the `NextAggregateVerificationKey` here, it would return uppercase bytes
      // `A-F` instead of `a-f`, leading to a different hash result.
      Pair(
        NextAggregateVerificationKey,
        @"7b226d745f636f6d6d69746d656e74223a7b22726f6f74223a5b37332c37342c3232392c3235302c3132322c3232362c38392c33372c3233312c3234352c3130362c3138332c3132372c332c39392c3137372c3231372c36352c3135322c3133352c33322c36372c3232332c33352c3134312c35312c342c3132352c3230332c33382c3139362c3231325d2c226e725f6c6561766573223a32342c22686173686572223a6e756c6c7d2c22746f74616c5f7374616b65223a35323337353137363336353838327d",
      ),
    ],
    signed_message: digest_to_bytes_of_string(
      #"82c7e6a3a8668ffee721af0ad4ea159ed6ac3792a2c58d890f740a349134db4a",
    ),
    aggregate_verification_key: digest_to_bytes_of_string(
      #"7b226d745f636f6d6d69746d656e74223a7b22726f6f74223a5b3134302c31332c3135352c3134312c3136332c372c38362c3232372c34372c31392c3138302c3132372c3139362c3130382c3137312c3135382c3134302c37372c3137352c3135392c3133362c3139332c3130382c34322c3134322c3234342c38352c3131362c3235322c3135362c3233352c35305d2c226e725f6c6561766573223a312c22686173686572223a6e756c6c7d2c22746f74616c5f7374616b65223a313030393439373433323536397d",
    ),
    signature: MultiSignature {
      signed_entity_type: MithrilStakeDistribution { epoch: 10 },
      signature: digest_to_bytes_of_string(
        #"7b227369676e617475726573223a5b5b7b227369676d61223a5b3137312c3136312c3232352c3139342c32382c39372c3138322c392c39362c3135302c3130342c3233332c332c372c35332c3130392c3139302c3137312c38372c392c39332c36392c3137352c3137342c3132302c332c3139342c39342c3132322c3234342c3138362c35312c3131342c34362c3135332c3233372c3132332c39332c3232332c35362c3235312c312c36372c3230322c34312c3133322c3135342c3130315d2c22696e6465786573223a5b31382c32362c33312c35322c35332c35372c36352c36392c37302c37332c37392c38372c39342c39362c3131322c3131372c3131382c3132312c3133302c3133312c3134302c3134322c3134382c3135342c3135372c3135392c3137312c3137352c3137372c3138392c3139322c3139352c3230362c3230395d2c227369676e65725f696e646578223a307d2c5b5b3135312c31392c39342c3234352c3233352c3132372c3130302c3131372c3132392c3137342c3133362c3130392c33342c3136332c3134312c3235342c3234332c39332c39352c3132382c3137382c3235312c3231362c3134342c3133342c39302c3232342c3133392c3133392c3134352c3131382c3131342c332c3234352c3230302c3136332c3230302c3137312c3231392c39352c3130302c3230382c34302c38372c3133312c3132312c3131302c3132342c31352c38332c34382c3132302c31392c33392c3132392c3138322c3135352c39382c3136352c3134302c3137332c3132392c3232302c3131382c34392c3230362c3131362c3137342c3136342c36322c39352c3230332c3139312c39362c3131372c32312c39382c32392c38342c32352c3232332c36342c312c3234382c3135392c37312c3136312c3232382c31392c37352c3134342c35332c3136392c3231372c3133382c36375d2c323030303030305d5d2c5b7b227369676d61223a5b3137302c3233382c3234302c3135312c33302c38312c3132322c37372c342c36332c3134352c32312c3231352c38382c3231332c3234342c3133382c36372c33352c37392c3233312c3231332c3136302c39342c3130332c36352c35322c3235302c3231302c35342c3135302c32372c3132302c3139332c3234322c3235342c3130352c3230372c3138332c3230372c3233342c3233342c3136322c3138382c3136382c3230332c3230352c39335d2c22696e6465786573223a5b312c322c332c342c352c362c372c382c31302c31312c31322c31342c31352c31362c31392c32302c32312c32322c32332c32352c32372c32382c32392c33322c33332c33342c33352c33382c33392c34302c34312c34322c34332c34342c34352c34362c34382c35302c35312c35342c35352c35362c35382c35392c36302c36312c36322c36332c36372c36382c37322c37342c37352c37362c37372c37382c38302c38312c38322c38352c38382c38392c39372c39382c3130312c3130322c3130332c3130342c3130352c3130362c3130372c3131302c3131312c3131332c3131342c3131352c3131362c3131392c3132302c3132322c3132342c3132352c3132362c3132372c3132382c3132392c3133322c3133342c3133362c3133392c3134312c3134332c3134342c3134352c3134362c3134392c3135312c3135322c3135332c3135362c3136302c3136312c3136322c3136342c3136352c3136362c3136372c3136382c3137302c3137322c3137332c3137342c3137362c3137382c3138302c3138312c3138322c3138332c3138342c3138352c3138362c3138382c3139342c3139372c3139382c3139392c3230312c3230322c3230332c3230342c3230372c3230385d2c227369676e65725f696e646578223a317d2c5b5b3137322c32352c32312c3132352c3133312c38302c3234382c37312c39302c3138302c37312c3137372c3232302c3132332c39342c3231372c3139332c33352c36322c33382c3135372c3135332c3231382c32372c3136342c38372c37342c322c3233352c3233332c3136322c39302c36332c3138302c3137302c3230332c3235332c3132382c37312c362c39312c3231332c35302c39392c3133372c3230382c34392c38382c32352c3139372c3136392c3133312c3130312c3139352c33332c36322c3130352c3234312c31372c32332c34312c31392c3135352c3138382c3134342c31382c3130342c35362c3136382c31352c3232312c3137322c3230332c3137322c3138382c33362c35302c362c3135362c34372c3135322c38372c3132302c3133302c312c3134352c302c3138342c32312c39362c38322c3233302c3132382c3134302c37342c34335d2c343030303030305d5d5d2c2262617463685f70726f6f66223a7b2276616c756573223a5b5d2c22696e6469636573223a5b302c315d2c22686173686572223a6e756c6c7d7d",
      ),
    },
  }
}

pub fn genesis_certificate_for_hash_test() -> MithrilCertificate {
  MithrilCertificate {
    // this does not make sense but this is the example in Mithril code, it should be ""
    prev_hash: "previous_hash",
    hash: #"6160fca853402c0ea89a0a9ceb5d97462ffd81c558c53feef01dcc0827f5bd19",
    epoch: 10,
    metadata: CertificateMetadata {
      network: "testnet",
      protocol_version: ProtocolVersion("0.1.0"),
      protocol_parameters: ProtocolParameters {
        k: 1000,
        m: 100,
        // 0.123
        phi_f: #"001f7cee",
      },
      initiated_at: #"17b31fabeef2bdac",
      sealed_at: #"17b31fc33769a5ac",
      signers: [
        StakeDistributionParty { party_id: "1", stake: 10 },
        StakeDistributionParty { party_id: "2", stake: 20 },
      ],
    },
    protocol_message: [
      Pair(SnapshotDigest, @"snapshot-digest-123"),
      Pair(
        NextAggregateVerificationKey,
        @"7b226d745f636f6d6d69746d656e74223a7b22726f6f74223a5b37332c37342c3232392c3235302c3132322c3232362c38392c33372c3233312c3234352c3130362c3138332c3132372c332c39392c3137372c3231372c36352c3135322c3133352c33322c36372c3232332c33352c3134312c35312c342c3132352c3230332c33382c3139362c3231325d2c226e725f6c6561766573223a32342c22686173686572223a6e756c6c7d2c22746f74616c5f7374616b65223a35323337353137363336353838327d",
      ),
    ],
    signed_message: digest_to_bytes_of_string(
      #"82c7e6a3a8668ffee721af0ad4ea159ed6ac3792a2c58d890f740a349134db4a",
    ),
    aggregate_verification_key: digest_to_bytes_of_string(
      #"7b226d745f636f6d6d69746d656e74223a7b22726f6f74223a5b37332c37342c3232392c3235302c3132322c3232362c38392c33372c3233312c3234352c3130362c3138332c3132372c332c39392c3137372c3231372c36352c3135322c3133352c33322c36372c3232332c33352c3134312c35312c342c3132352c3230332c33382c3139362c3231325d2c226e725f6c6561766573223a32342c22686173686572223a6e756c6c7d2c22746f74616c5f7374616b65223a35323337353137363336353838327d",
    ),
    signature: GenesisSignature {
      signature: digest_to_bytes_of_string(
        #"ebc0652ffe864970a2ba538eacf7d088e9840e3db883c96d13eb6c5b4c74cfc6e84932e4640ca9e3b5e3de2dd615247a88c011405cc7508736abcf99cae2b10b",
      ),
    },
  }
}

pub fn standard_sd_certificate_with_incorrect_parent_hash() -> MithrilCertificate {
  MithrilCertificate {
    prev_hash: "incorrect_parent_certificate_hash",
    hash: "sd_certificate_hash",
    epoch: 1150,
    metadata: mock_certificate_metadata(),
    protocol_message: mock_protocol_message(1150),
    signed_message: #"abcdef123456",
    aggregate_verification_key: "avk",
    signature: MultiSignature {
      signed_entity_type: MithrilStakeDistribution { epoch: 1150 },
      signature: #"0123456789abcdef",
    },
  }
}

pub fn parent_of_standard_sd_certificate_with_incorrect_parent_hash() -> MithrilCertificate {
  MithrilCertificate {
    prev_hash: "incorrect_parent_certificate_hash",
    hash: "sd_certificate_hash",
    epoch: 1149,
    metadata: mock_certificate_metadata(),
    protocol_message: mock_protocol_message(1149),
    signed_message: #"abcdef123456",
    aggregate_verification_key: "avk",
    signature: MultiSignature {
      signed_entity_type: MithrilStakeDistribution { epoch: 1149 },
      signature: #"0123456789abcdef",
    },
  }
}

pub fn standard_sd_certificate_with_incorrect_epoch_chaining() -> MithrilCertificate {
  let incorrect_epoch: Int = 10000
  let genesis_certificate = simple_genesis_certificate()
  MithrilCertificate {
    prev_hash: genesis_certificate.hash,
    hash: "sd_certificate_hash",
    epoch: incorrect_epoch,
    metadata: mock_certificate_metadata(),
    protocol_message: mock_protocol_message(incorrect_epoch),
    signed_message: #"abcdef123456",
    aggregate_verification_key: "avk",
    signature: MultiSignature {
      signed_entity_type: MithrilStakeDistribution { epoch: incorrect_epoch },
      signature: #"0123456789abcdef",
    },
  }
}

pub fn standard_sd_certificate_with_incorrect_aggregate_verification_key() -> MithrilCertificate {
  MithrilCertificate {
    // It is very important to notice that we are passing a string here. Since this is how Mithril processes it.
    prev_hash: string.to_bytearray(
      @"d6b8be9f69f9a4c304ddaadba8c7ba18b98faf88aa1bc7c372cfc24b34c35c69",
    ),
    hash: #"062028d9a71eb9178dabe0018d161d5bc6773a331c3759f8f05661718296387f",
    epoch: 1130,
    metadata: CertificateMetadata {
      network: "preview",
      protocol_version: ProtocolVersion("0.1.0"),
      protocol_parameters: ProtocolParameters {
        k: 5,
        m: 100,
        // phi_f = 0.65
        phi_f: #"00a66666",
      },
      // initiated_at = 2025-11-28T00:02:32.958938259Z
      initiated_at: #"187c02ba3e8c2c93",
      // sealed_at = 2025-11-28T00:03:32.954265042Z
      sealed_at: #"187c02c8368c35d2",
      signers: [
        StakeDistributionParty {
          party_id: "pool1xgmqwh23yc2jp52k7jn249x56v6nyhl9nhxaeg6hq8tmc5t78rq",
          stake: 13617227733327,
        },
        StakeDistributionParty {
          party_id: "pool15jqsjphnxg7hcx2rvd0ryhg5xwshg7xktthj3zf70nmxx9ffjet",
          stake: 460613554490,
        },
        StakeDistributionParty {
          party_id: "pool1knap9hldvhww0fjqew26sxkfjpj3c8tp8uuj7j3729lzqn9x70r",
          stake: 49960508305352,
        },
        StakeDistributionParty {
          party_id: "pool1y0uxkqyplyx6ld25e976t0s35va3ysqcscatwvy2sd2cwcareq7",
          stake: 45661020404878,
        },
        StakeDistributionParty {
          party_id: "pool1myvqymdmf9f26746d6uvfk34hqr7lq998n43xprgz4c27tpa6rd",
          stake: 1232019292237,
        },
      ],
    },
    protocol_message: [
      Pair(
        NextAggregateVerificationKey,
        @"7b226d745f636f6d6d69746d656e74223a7b22726f6f74223a5b31312c3130312c3232362c3138372c36392c3230382c3135332c33362c3139372c3232352c34302c3235332c3135332c33382c3139342c3136362c3133352c3137392c3230392c33312c3134362c32372c37382c3137302c34312c3139302c3138372c3136342c39382c34322c3131322c36305d2c226e725f6c6561766573223a31392c22686173686572223a6e756c6c7d2c22746f74616c5f7374616b65223a313231303536363437313039333432347d",
      ),
      Pair(
        NextProtocolParameters,
        @"b01de82ca7e57c1bf2a56381ce265f378aeea5f1dde7f824b5ba42125c4adad2",
      ), Pair(CurrentEpoch, @"1130"),
    ],
    signed_message: digest_to_bytes_of_string(
      #"d5b0115f14a1db581ef039bb343a200a07c2c1e38b3388a4fc07b09e7b5b844f",
    ),
    aggregate_verification_key: "some_different_aggregate_verification_key",
    signature: MultiSignature {
      signed_entity_type: MithrilStakeDistribution { epoch: 1130 },
      signature: digest_to_bytes_of_string(
        #"7b227369676e617475726573223a5b5b7b227369676d61223a5b3137382c36302c3136322c3138352c3130372c32302c3136362c3135332c32352c32392c3235342c3234392c3230382c3232382c38312c3138382c32312c3230332c3135302c3234362c3131352c3134302c31312c3230362c39392c36342c3139332c3233342c32392c3133362c3138342c34382c3231392c3233342c37332c31312c33322c33352c34352c39312c34352c3139392c3132362c3137362c3231382c32362c3139352c3136345d2c22696e6465786573223a5b345d2c227369676e65725f696e646578223a347d2c5b5b3138302c3230342c3233372c3230342c3232382c32302c3135312c3138372c3131352c3134342c3138302c31312c3134332c3134312c3232342c38322c32372c3235322c35312c3232322c3232322c36382c37352c32372c39362c34382c3235352c35352c3232332c332c37302c3135362c37322c35302c342c3234372c3139382c3130302c3235302c3230322c3135332c3231372c31302c3136352c32382c3232332c3139352c32342c32322c3134382c38382c37322c3135342c3234382c3131392c3130342c3133362c3234352c34302c3230352c3133332c3234332c332c3132352c34392c3133322c34392c3137332c3135392c3139322c3130332c3137332c3230322c3137342c3234322c36322c3133312c38362c31352c3137392c37332c36362c3233392c3137302c3130372c3134362c3234312c3231352c35372c38332c3134342c3133302c3233382c3230392c3232302c31345d2c313233323031393239323233375d5d2c5b7b227369676d61223a5b3134342c34362c37322c3231332c3135302c3233342c3132382c3133322c3138362c33352c3232342c33382c3136332c3233312c3135382c3137322c38342c3132322c32312c3235302c3232302c3231352c38372c3233322c35342c3234342c3131302c3136342c38372c39332c33332c3130342c38312c3233332c3138312c32392c3235312c32362c3138332c3235332c3134362c39332c3138342c3136322c3136312c35392c3235312c3231375d2c22696e6465786573223a5b33342c35382c38325d2c227369676e65725f696e646578223a31317d2c5b5b3137382c35372c3232382c3231362c3235322c39322c32302c36362c3137312c35372c3232332c31372c3230322c33372c3135362c37342c33332c3233362c3131392c3230362c3130372c3133372c3133302c3230342c3233312c34372c3136312c3131312c3135352c32382c3136312c31302c3234322c3131372c31302c3230302c3134352c32382c36372c37312c3233382c3235342c3131352c3130392c3135302c3133342c3137322c3135362c382c37342c3138392c3233362c3233302c3232352c3233372c3235302c36342c3137382c312c37372c3232382c3133342c3135342c3137302c34332c3133362c32302c39312c3137302c33322c3131332c3132382c3138372c3131382c3132322c38302c3133352c3138362c3234332c3232392c35392c3134382c3230302c3135322c3131382c3133302c37382c3130382c3233322c3132322c3133302c31352c3133372c36302c37352c3137365d2c31333631373232373733333332375d5d2c5b7b227369676d61223a5b3137362c3136332c38352c302c3134322c3135392c31372c36342c3130312c31342c3231392c3138352c3139332c3135342c38302c3138392c34392c3131382c3130302c32332c3136392c31372c33392c34362c3137332c3230382c37352c3136392c362c3136352c3232392c3136302c35382c3134372c36372c3134322c32322c372c3139382c34362c3137342c3235332c3230372c3137322c39332c3130312c3233342c3133365d2c22696e6465786573223a5b31302c34312c39395d2c227369676e65725f696e646578223a31347d2c5b5b3138352c3137302c31322c3134362c35322c33342c35392c3136332c3131322c3130392c3235332c3137362c35322c39382c3135352c3134392c3135332c342c39322c3132342c3136362c3233302c3132302c37342c31332c322c39312c3232342c33302c3232382c3133332c3235352c3139302c3137352c3131392c3233352c372c39352c3136342c3130322c3234312c3233362c32302c31392c3133372c35312c342c3130352c31302c37372c3131342c31302c38342c36332c38302c3134362c33302c3235332c3138332c332c3133302c37362c35332c3230382c35392c3232372c39332c37332c3137302c3138352c3131352c3233302c3231352c3139342c3235322c3137312c3130362c3235332c3231322c3233392c3138352c3130332c36352c3136392c38342c39342c39302c3135322c3135302c3138372c3135372c3134342c3231322c362c38382c39375d2c34353636313032303430343837385d5d5d2c2262617463685f70726f6f66223a7b2276616c756573223a5b5b3231382c3139322c38302c37352c37302c3131352c3131372c34352c3232312c3136342c3137302c3137322c39392c31322c32312c37322c3136382c3132372c382c3133302c3132362c39392c322c3133392c34302c3134322c38372c3139372c37372c38322c31312c37385d2c5b39372c3133312c3233372c35312c36332c3134342c33332c34342c35322c3234322c3136322c36372c3132312c3136362c35352c3235332c39392c3132372c3131312c34352c35362c3138362c32392c33322c3231382c3232322c3132342c36382c3131382c32342c35382c3135315d2c5b3132332c382c3138382c34312c3137392c3136382c3234312c35392c39312c32312c3231392c332c3138392c3135322c37382c3132342c3234392c37392c33342c39312c3234362c3235322c32302c3131302c33342c3231372c3132342c35352c3131392c382c3137302c3132335d2c5b3231362c37332c3138302c33312c3234342c3139372c35372c3131342c3130302c3231372c3231332c3232322c3139332c3137382c3134302c3233382c3233342c3233352c35352c3139332c3137392c38392c33302c3137312c3132332c3231372c3134332c39352c3230332c3230392c302c32375d2c5b3135392c3135362c3233342c3137382c3232332c3234362c3235332c3231322c3138312c3234322c35372c32312c3234362c3132332c3135392c31382c3138372c3131302c3234392c31372c35352c3231302c3134362c3139322c3132372c32382c342c3132312c36372c31312c3135372c355d2c5b3132322c3137362c3137312c3231302c3232372c3138352c3132352c3130342c382c3135352c3233332c33302c3231302c31392c3138312c382c32302c3137342c31382c36352c3233322c3133332c3132372c3231362c3230322c3232342c3130372c3230372c3132362c35352c3230342c38305d2c5b3230352c38382c37382c382c3134362c3135392c3231352c39392c3233352c3134342c36352c39362c312c3131332c33322c3130382c34332c3136312c37342c35392c32382c38302c3138392c3233342c3230332c32302c3131362c39362c31352c3233372c3139322c335d2c5b32382c39302c37392c3134322c382c35392c3133302c3131302c36322c3234302c3232372c32352c33382c38362c3131352c33302c39322c3234312c36322c3130342c3233332c3136312c31362c3133312c37332c31312c3139312c3133332c3137312c37352c3234372c33365d5d2c22696e6469636573223a5b342c31312c31345d2c22686173686572223a6e756c6c7d7d",
      ),
    },
  }
}

pub fn standard_sd_certificate_with_incorrect_protocol_parameters() -> MithrilCertificate {
  MithrilCertificate {
    prev_hash: string.to_bytearray(
      @"d6b8be9f69f9a4c304ddaadba8c7ba18b98faf88aa1bc7c372cfc24b34c35c69",
    ),
    hash: #"062028d9a71eb9178dabe0018d161d5bc6773a331c3759f8f05661718296387f",
    epoch: 1130,
    metadata: CertificateMetadata {
      network: "preview",
      protocol_version: ProtocolVersion("0.1.0"),
      protocol_parameters: ProtocolParameters {
        k: 7,
        m: 200,
        // phi_f = 0.123
        phi_f: #"001f7cee",
      },
      initiated_at: #"187c02ba3e8c2c93",
      sealed_at: #"187c02c8368c35d2",
      signers: [],
    },
    protocol_message: [
      Pair(
        NextAggregateVerificationKey,
        @"7b226d745f636f6d6d69746d656e74223a7b22726f6f74223a5b31312c3130312c3232362c3138372c36392c3230382c3135332c33362c3139372c3232352c34302c3235332c3135332c33382c3139342c3136362c3133352c3137392c3230392c33312c3134362c32372c37382c3137302c34312c3139302c3138372c3136342c39382c34322c3131322c36305d2c226e725f6c6561766573223a31392c22686173686572223a6e756c6c7d2c22746f74616c5f7374616b65223a313231303536363437313039333432347d",
      ),
      Pair(
        NextProtocolParameters,
        @"b01de82ca7e57c1bf2a56381ce265f378aeea5f1dde7f824b5ba42125c4adad2",
      ), Pair(CurrentEpoch, @"1130"),
    ],
    signed_message: digest_to_bytes_of_string(
      #"d5b0115f14a1db581ef039bb343a200a07c2c1e38b3388a4fc07b09e7b5b844f",
    ),
    aggregate_verification_key: digest_to_bytes_of_string(
      #"7b226d745f636f6d6d69746d656e74223a7b22726f6f74223a5b3235352c3130352c312c3133322c3232342c33362c3139392c37382c3138352c36362c3230392c3138332c3230342c3139332c3138392c3137352c33392c35332c3139392c3134352c3138372c39372c3234312c3230302c3232382c3232302c302c3130382c3136332c3130372c3131312c3230325d2c226e725f6c6561766573223a31392c22686173686572223a6e756c6c7d2c22746f74616c5f7374616b65223a313231303337383339303633353238307d",
    ),
    signature: MultiSignature {
      signed_entity_type: MithrilStakeDistribution { epoch: 1130 },
      signature: digest_to_bytes_of_string(#""),
    },
  }
}

pub fn standard_sd_certificate_with_incorrect_signed_entity_type() -> MithrilCertificate {
  MithrilCertificate {
    prev_hash: string.to_bytearray(
      @"d6b8be9f69f9a4c304ddaadba8c7ba18b98faf88aa1bc7c372cfc24b34c35c69",
    ),
    hash: #"062028d9a71eb9178dabe0018d161d5bc6773a331c3759f8f05661718296387f",
    epoch: 1130,
    metadata: CertificateMetadata {
      network: "preview",
      protocol_version: ProtocolVersion("0.1.0"),
      protocol_parameters: ProtocolParameters {
        k: 5,
        m: 100,
        // phi_f = 0.65
        phi_f: #"00a66666",
      },
      initiated_at: #"187c02ba3e8c2c93",
      sealed_at: #"187c02c8368c35d2",
      signers: [],
    },
    protocol_message: [],
    signed_message: digest_to_bytes_of_string(
      #"d5b0115f14a1db581ef039bb343a200a07c2c1e38b3388a4fc07b09e7b5b844f",
    ),
    aggregate_verification_key: digest_to_bytes_of_string(#""),
    signature: MultiSignature {
      signed_entity_type: CardanoTransactions {
        epoch: 1130,
        block_number: 3867929,
      },
      signature: digest_to_bytes_of_string(#""),
    },
  }
}

// TODO: ver que onda es esto cuando me ponga a ver el minting validator
pub fn simple_standard_certificate_for_locking_tx_inclusion() -> MithrilCertificate {
  let sd_certificate = simple_cardano_transactions_certificate()
  MithrilCertificate {
    prev_hash: digest_to_bytes_of_string(sd_certificate.hash),
    hash: "locking_tx_certificate_hash",
    epoch: sd_certificate.epoch,
    metadata: certificate_metadata_for_new_certificate(sd_certificate),
    protocol_message: mock_protocol_message(1150),
    signed_message: #"abcdef123456",
    aggregate_verification_key: sd_certificate.aggregate_verification_key,
    signature: MultiSignature {
      signed_entity_type: MithrilStakeDistribution { epoch: 1150 },
      signature: #"0123456789abcdef",
    },
  }
}
